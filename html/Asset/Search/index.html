<%init>
my $assets = RT::Assets->new($session{CurrentUser});

for my $key (keys %ARGS) {
    next unless defined $ARGS{$key} and length $ARGS{$key};
    if ($key =~ /^(Name|Description)$/) {
        $assets->Limit(
            FIELD => $key,
            OPERATOR => 'LIKE',
            VALUE => $ARGS{$key},
        );
    }
}
$assets->LimitToActiveStatus;

my $Format = RT->Config->Get('AssetSearchFormat') || q[
    '<b><a href="__WebPath__/Asset/Display.html?id=__id__">__id__</a></b>/TITLE:#',
    '<b><a href="__WebPath__/Asset/Display.html?id=__id__">__Name__</a></b>/TITLE:Name',
    Description,
    Status,
];
</%init>
<& /Elements/Header, Title => loc("Assets") &>
<& /Elements/Tabs &>

<& /Elements/CollectionList,
    Collection      => $assets,
    OrderBy         => 'Name',
    Order           => 'ASC',
    Format          => $Format,
    AllowSorting    => 0,
    &>

<&|/Widgets/TitleBox, title => "Search Assets" &>
<form action="<% RT->Config->Get('WebPath') %>/Asset/Search/index.html" name="AssetSearch">

<table>
<tr><td class="label"><label for="Name"><&|/l&>Name</&></label></td>
    <td class="value"><input type="text" id="Name" name="Name" value="<% $ARGS{Name} || ''%>" /></td></tr>
<tr><td class="label"><label for="Description"><&|/l&>Description</&></label></td>
    <td class="value"><input type="text" id="Description" name="Description" value="<% $ARGS{Description} || ''%>" /></td></tr>

</table>

<& /Elements/Submit, Label => loc('Search') &>
</form>

</&>

